# php-resque的队列实现

- 所有的消息队列都差不多,有生产者,消费者,还有Task Server.只不过名称不同而已.
- 生产者:接受用户提交信息,组成消息队列中的一个任务,并将其加入消息队列服务中.
- 消费者:一般为一个守护进程,从消息队列服务器中取出任务,对任务做出相应的处理.PHP-Resque中的消息者为守护进程+Job Class .即由守护进程从消息队列中取出任务,具体的任务中在任务的生产过程中已经指定了由哪个Job Class来做具体的处理.
- Task Server: 消息队列服务器,本处指redis服务.

# 后台任务的角色划分

- Job | 任务 ： 一个Job就是一个需要在后台完成的任务，比如本文举例的发送邮件，就可以抽象为一个Job。在Resque中一个Job就是一个Class。
- Queue | 队列 ： 也就是上文的消息队列，在Resque中，队列则是由Redis实现的。Resque还提供了一个简单的队列管理器，可以实现将Job插入/取出队列等功能。
- Worker | 执行者 ： 负责从队列中取出Job并执行，可以以守护进程的方式运行在后台。

# 那么基于这个划分，一个后台任务在Resque下的基本流程是这样的：

将一个后台任务编写为一个独立的Class，这个Class就是一个Job。
在需要使用后台程序的地方，系统将Job Class的名称以及所需参数放入队列。
以命令行方式开启一个Worker，并通过参数指定Worker所需要处理的队列。
Worker作为守护进程运行，并且定时检查队列。
当队列中有Job时，Worker取出Job并运行，即实例化Job Class并执行Class中的方法。